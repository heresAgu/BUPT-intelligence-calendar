<!-- pages/index/index.wxml -->
<view class="page-container">
  <!-- æ—¥å†åŒºåŸŸ -->
  <view class="calendar-section">
    <picker mode="date" value="{{currentDate}}" bindchange="onDateChange">
      <view class="date-picker">
        <text class="date">{{currentDate}}</text>
        <text class="iconfont icon-calendar"></text>
      </view>
    </picker>
    
    <calendar 
      bind:dayClick="onDateChange"
      markedDates="{{markedDates}}"
      config="{{calendarConfig}}"
    />
  </view>

  <!-- å½“æ—¥ä½œä¸šåˆ—è¡¨ -->
  <view class="assignments-section">
    <view class="section-header">
      <text class="section-title">ä»Šæ—¥ä½œä¸š ({{assignments.length}})</text>
      <button class="add-btn" bindtap="goToAddAssignment">
        <text class="iconfont icon-add"></text>
        æ·»åŠ 
      </button>
    </view>

    <view class="assignments-list" wx:if="{{assignments.length > 0}}">
      <view 
        class="assignment-item" 
        wx:for="{{assignments}}" 
        wx:key="id"
        data-id="{{item.id}}"
        bindtap="goToAssignmentDetail"
      >
        <view class="assignment-header">
          <view class="assignment-title">{{item.title}}</view>
          <view 
            class="priority-badge" 
            style="background-color: {{getPriorityColor(item.priority)}}"
          >
            {{['ä½','ä¸­','é«˜'][item.priority] || 'æœªçŸ¥'}}
          </view>
        </view>
        
        <view class="assignment-info">
          <text class="course-name">{{item.courseName || 'æœªåˆ†ç±»'}}</text>
          <text class="due-date">æˆªæ­¢: {{item.dueDate}}</text>
        </view>
        
        <view class="assignment-actions">
          <button 
            class="complete-btn" 
            data-id="{{item.id}}"
            bindtap="markAsComplete"
            catchtap
            wx:if="{{item.status === 0}}"
          >
            æ ‡è®°å®Œæˆ
          </button>
          <text class="status-done" wx:else>å·²å®Œæˆ</text>
        </view>
      </view>
    </view>

    <view class="empty-state" wx:else>
      <image src="/assets/icons/empty.png" class="empty-icon"></image>
      <text class="empty-text">ä»Šå¤©æ²¡æœ‰ä½œä¸šï¼Œä¼‘æ¯ä¸€ä¸‹å§ï¼</text>
      <button class="primary-btn" bindtap="goToAddAssignment">æ·»åŠ ä½œä¸š</button>
    </view>
  </view>

  <!-- å¿«æ·æ“ä½œ -->
  <view class="quick-actions">
    <view class="action-item" bindtap="goToAddAssignment">
      <view class="action-icon add-icon">+</view>
      <text>å¿«é€Ÿæ·»åŠ </text>
    </view>
    <view class="action-item" bindtap="scanAssignment">
      <view class="action-icon scan-icon">ğŸ“·</view>
      <text>æ‰«ç æ·»åŠ </text>
    </view>
    <view class="action-item" bindtap="viewAllAssignments">
      <view class="action-icon list-icon">ğŸ“‹</view>
      <text>å…¨éƒ¨ä½œä¸š</text>
    </view>
  </view>
</view>